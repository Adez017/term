#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run ESLint on staged files
FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(jsx?|tsx?)$')
if [ -n "$FILES" ]; then
  echo "üîç Linting and formatting TypeScript/JavaScript files..."
  npx eslint $FILES --fix
  npx prettier --write $FILES
  git add $FILES
fi

# Run rustfmt on Rust files
RUST_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.rs$')
if [ -n "$RUST_FILES" ]; then
  echo "üîç Formatting Rust files..."
  cd src-tauri && cargo fmt
  git add $RUST_FILES
fi

echo "‚úÖ Pre-commit checks passed!"
